<!doctype html>
<html lang="mr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‡§Ü‡§ú‡§ö‡•á ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó ‚Äî OmKarmyog</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&family=Noto+Sans+Devanagari:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
  :root{
    --card-w:1080;
    --card-h:1920;
    --cream:#fff9f1;
    --maroon-1:#5a0e0e;
    --gold:#d9a64b;
    --saffron:#e56a2e;
    --blue-1:#1565c0;
    --blue-2:#0d47a1;
    --dark:#0b2b3a;
    --muted:#6d6d6d;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    background:linear-gradient(180deg,#eef6ec,#e9f0ef);
    font-family:'Noto Sans Devanagari',sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    display:flex;
    justify-content:center;
    padding:18px;
  }

  .page {
    width:100%;
    max-width:1200px;
    display:flex;
    flex-direction:column;
    gap:18px;
    align-items:center;
  }

  /* INPUT PANEL - placed ABOVE the card (not fixed) */
  .input-panel{
    width:100%;
    max-width:1200px;
    background:#ffffff;
    border-radius:12px;
    padding:14px;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    align-items:center;
  }
  .input-panel input[type="text"],
  .input-panel input[type="tel"],
  .input-panel input[type="file"]{
    padding:10px;
    border:2px solid #e8e8e8;
    border-radius:8px;
    font-size:16px;
  }
  .input-panel .grow{flex:1;min-width:160px}
  .input-panel button{background:linear-gradient(135deg,#d32f2f,#c62828);color:#fff;border:0;padding:12px 18px;border-radius:8px;font-weight:800;cursor:pointer}
  .input-panel label{font-weight:700;font-size:14px;color:#333;margin-right:6px}
  .input-panel .note{font-size:12px;color:#666;margin-left:6px}

  /* CARD (visual) - responsive */
  .card-wrap{width:100%;display:flex;justify-content:center}
  #panchangCard{
    width:100%;
    max-width:1080px;
    aspect-ratio: 1080 / 1920;
    background:var(--cream);
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 26px 60px rgba(0,0,0,.28);
    position:relative;
    display:flex;
    flex-direction:column;
  }

  /* Header: left (title/date/day), center ganesh (absolute center), right logo */
  .top-header{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    padding:28px 36px;
    background:#fff;
    border-bottom:8px solid var(--gold);
    position:relative;
    min-height:220px;
  }
  .top-left{width:340px}
  .title{font-family:'Baloo 2';font-size:40px;font-weight:800;color:var(--dark)}
  .top-date{font-size:26px;font-weight:900;color:#c62828;margin-top:8px}
  .top-day{font-size:22px;font-weight:700;color:#d32f2f;margin-top:6px}

  .ganesh-center{
    position:absolute;
    left:50%;
    top:20px;
    transform:translateX(-50%);
    width:260px;height:260px;
    display:flex;align-items:center;justify-content:center;
  }
  .ganesh-center img{width:100%;height:100%;object-fit:contain;filter:drop-shadow(0 8px 24px rgba(0,0,0,.35))}

  .logo-right{width:160px;height:120px;display:flex;align-items:center;justify-content:flex-end}
  .logo-right img{max-width:120px;max-height:100%;object-fit:contain}

  /* Shalivahan */
  .shalivahan{
    background:linear-gradient(180deg,#c62828,#b71c1c);
    color:#fff;text-align:center;padding:20px 26px;border-bottom:6px solid var(--gold)
  }
  .shalivahan h3{font-family:'Baloo 2';font-size:30px;margin-bottom:6px}
  .shalivahan p{font-size:22px;margin:0;opacity:0.95}

  /* Sunrise / sunset */
  .sun-row{display:flex;gap:24px;justify-content:center;padding:18px 16px;background:linear-gradient(90deg,var(--blue-1),var(--blue-2));border-bottom:6px solid var(--gold)}
  .sun-box{display:flex;align-items:center;gap:14px;padding:10px 18px;border-radius:40px;background:rgba(255,255,255,0.08)}
  .sun-icon{width:64px;height:64px;background:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;box-shadow:0 4px 12px rgba(0,0,0,.2)}
  .sun-info h4{color:#fff;font-size:14px;margin:0}
  .sun-info .time{color:var(--gold);font-weight:900;font-size:22px}

  /* Table simplified */
  .table-section{padding:18px;background:linear-gradient(180deg,#fff8e6,#ffffff)}
  .p-table{width:100%;border-collapse:collapse;border-left:4px solid #ff9800;border-right:4px solid #ff9800}
  .p-table tr{border-bottom:2px solid #f2d2b0}
  .p-table td{padding:16px;font-weight:800;vertical-align:middle;font-size:18px}
  .p-table td.event{width:18%;color:var(--muted);text-align:left;padding-left:22px}
  .p-table td.info{width:42%;text-align:left;padding-left:14px;font-size:20px}
  .p-table td.time{width:20%;text-align:center;color:#c62828;font-weight:900}
  .p-table td.next{width:20%;text-align:center;color:var(--muted);font-weight:700}

  /* Rashi boxes (3) */
  .rashi-wrap{display:flex;gap:16px;padding:18px;background:#fff;justify-content:space-between}
  .rashi{flex:1;background:#fff;border:3px solid #ff9800;border-radius:12px;padding:18px;text-align:center;box-shadow:0 8px 20px rgba(0,0,0,.06)}
  .rashi .icon{font-size:28px;margin-bottom:8px}
  .rashi .label{color:#666;font-size:14px}
  .rashi .val{font-size:20px;color:#c62828;font-weight:900}

  /* Din vishesh */
  .din-box{margin:18px;padding:12px 18px;background:linear-gradient(180deg,#fff8e6,#fff2d9);border-radius:10px;border:2px solid #e2a92f;font-weight:800;color:var(--dark);margin-left:18px;margin-right:18px}

  /* Footer dark maroon */
  .footer{display:flex;gap:18px;align-items:center;justify-content:space-between;padding:22px;border-top:8px solid var(--gold);background:linear-gradient(90deg,var(--maroon-1),var(--maroon-1));color:#fff;margin-top:auto}
  .footer-left{flex:1}
  .u-name{font-family:'Baloo 2';font-size:34px;color:#ffd84a;font-weight:900}
  .u-office{font-size:18px;color:#fff;margin-top:6px;font-weight:700}
  .u-contact{font-size:18px;color:#fff;margin-top:6px}
  .u-address{font-size:16px;color:#fff;margin-top:8px;opacity:0.95}
  .footer-photo{width:220px;height:300px;border-radius:12px;border:6px solid var(--gold);object-fit:cover;box-shadow:0 8px 28px rgba(0,0,0,.28)}

  /* small screens: scale card visually but keep internal layout readable */
  @media (max-width:1100px){
    .input-panel{padding:12px;gap:8px}
    #panchangCard{max-width:880px}
    .top-left{width:260px}
  }
  @media (max-width:820px){
    .input-panel{flex-direction:column;align-items:stretch}
    #panchangCard{max-width:640px}
    .ganesh-center{width:200px;height:200px;top:14px}
    .u-name{font-size:28px}
    .footer-photo{width:180px;height:240px}
  }
  @media (max-width:480px){
    #panchangCard{max-width:420px}
    .title{font-size:30px}
    .top-date{font-size:18px}
    .top-day{font-size:16px}
    .ganesh-center{width:160px;height:160px}
    .footer-photo{width:160px;height:220px}
    .u-name{font-size:24px}
  }
</style>
</head>
<body>
  <div class="page">
    <!-- INPUT PANEL (placed above the card, not overlapping) -->
    <div class="input-panel" role="region" aria-label="Input panel">
      <div class="grow">
        <label>‡§®‡§æ‡§µ</label><br>
        <input id="nameInput" type="text" placeholder="‡§Ü‡§™‡§≤‡•á ‡§®‡§æ‡§µ (‡§â‡§¶‡§æ. ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§∞‡§æ‡§Æ‡§¶‡§æ‡§∏‡•Ä)" />
      </div>

      <div style="width:220px">
        <label>‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø</label><br>
        <input id="officeInput" type="text" placeholder="‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø / ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)" />
      </div>

      <div style="width:180px">
        <label>‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï</label><br>
        <input id="contactInput" type="tel" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤" />
      </div>

      <div style="width:200px">
        <label>‡§™‡§§‡•ç‡§§‡§æ</label><br>
        <input id="addressInput" type="text" placeholder="‡§™‡§§‡•ç‡§§‡§æ (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)" />
      </div>

      <div>
        <label>‡§´‡•ã‡§ü‡•ã</label><br>
        <input id="fileInput" type="file" accept="image/*" />
      </div>

      <div style="min-width:140px;display:flex;flex-direction:column;gap:8px;align-items:flex-end;">
        <button id="applyBtn">Apply</button>
        <div class="note">Admin: update <code>panchang.json</code> in repo root</div>
      </div>
    </div>

    <!-- CARD -->
    <div class="card-wrap">
      <div id="panchangCard" role="main" aria-label="Panchang card">
        <!-- TOP -->
        <div class="top-header">
          <div class="top-left">
            <div class="title">‡§Ü‡§ú‡§ö‡•á ‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó</div>
            <div class="top-date" id="hdrDate">--</div>
            <div class="top-day" id="hdrDay">--</div>
          </div>

          <div class="ganesh-center" aria-hidden="true">
            <img id="ganeshImg" src="https://raw.githubusercontent.com/sanketramdasi264-prog/panchang/main/pngtree-artistic-vinayaka-chavithi-celebrations-for-ganesh-chaturthi-bal-free-transparent-png-image_14089909.png" crossOrigin="anonymous" alt="Ganesh">
          </div>

          <div class="logo-right">
            <img id="logoImg" src="https://blogger.googleusercontent.com/img/a/AVvXsEghUXDnRLeFXsuapWEpRem_Mtzst5Ae9zlttWprP9nI7dQ_Rh41nkHP3PqCiHrZo1YKUiMvbHaPZC6VZEBCSvuAvzQOVF7MxUon4i3Hdko0qGWwyl4BQ44KeAe-6qQACSUB8k-3wdI6N2Bt-8xsQSQnHW-a2AMw9SwT0hK4b5Ej5zmN_anbnY1pX2TC9pwR=s500" crossOrigin="anonymous" alt="Logo">
          </div>
        </div>

        <!-- SHALIVAHAN -->
        <div class="shalivahan">
          <h3 id="shalivahanLine">‡§∂‡§æ‡§≤‡§ø‡§µ‡§æ‡§π‡§® ‡§∂‡§ï‡•á ‡•ß‡•Ø‡•™‡•≠</h3>
          <p id="shalivahanMeta">‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§µ‡§∏‡•Å‡§®‡§æ‡§Æ‡§∏‡§Ç‡§µ‡§§‡•ç‡§∏‡§∞, ‡§¶‡§ï‡•ç‡§∑‡§ø‡§£‡§æ‡§Ø‡§®, ‡§∂‡§∞‡§¶‡§ã‡§§‡•Ç, ‡§ï‡§æ‡§∞‡•ç‡§§‡§ø‡§ï ‡§Æ‡§æ‡§∏, ‡§ï‡•É‡§∑‡•ç‡§£ ‡§™‡§ï‡•ç‡§∑</p>
        </div>

        <!-- SUN -->
        <div class="sun-row">
          <div class="sun-box"><div class="sun-icon">üåÖ</div><div class="sun-info"><h4>‡§∏‡•Ç‡§∞‡•ç‡§Ø‡•ã‡§¶‡§Ø</h4><div id="sunrise" class="time">--:--</div></div></div>
          <div class="sun-box"><div class="sun-icon">üåÑ</div><div class="sun-info"><h4>‡§∏‡•Ç‡§∞‡•ç‡§Ø‡§æ‡§∏‡•ç‡§§</h4><div id="sunset" class="time">--:--</div></div></div>
        </div>

        <!-- TABLE (simplified). Show P (‡§™) and N (‡§®‡§Ç) markers inline -->
        <div class="table-section">
          <table class="p-table" role="table" aria-label="Panchang details">
            <tbody>
              <tr>
                <td class="event">‡§§‡§ø‡§•‡•Ä</td>
                <td class="info" id="tithiName">--</td>
                <td class="time" id="tithiTime">--</td>
                <td class="next" id="tithiNext">--</td>
              </tr>
              <tr>
                <td class="event">‡§µ‡§æ‡§∞</td>
                <td class="info" id="vaar">--</td>
                <td class="time" id="vaarTime">--</td>
                <td class="next" id="vaarSanskrit">--</td>
              </tr>
              <tr>
                <td class="event">‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞</td>
                <td class="info" id="nakshatra">--</td>
                <td class="time" id="nakshatraTime">--</td>
                <td class="next" id="nakshatraNext">--</td>
              </tr>
              <tr>
                <td class="event">‡§Ø‡•ã‡§ó</td>
                <td class="info" id="yog">--</td>
                <td class="time" id="yogTime">--</td>
                <td class="next" id="yogNext">--</td>
              </tr>
              <tr>
                <td class="event">‡§ï‡§∞‡§£</td>
                <td class="info" id="karan">--</td>
                <td class="time" id="karanTime">--</td>
                <td class="next" id="karanNext">--</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- RASHI (3 items) -->
        <div class="rashi-wrap">
          <div class="rashi"><div class="icon">üåô</div><div class="label">‡§ö‡§Ç‡§¶‡•ç‡§∞</div><div class="val" id="moonRashi">--</div></div>
          <div class="rashi"><div class="icon">‚òÄÔ∏è</div><div class="label">‡§∏‡•Ç‡§∞‡•ç‡§Ø</div><div class="val" id="sunRashi">--</div></div>
          <div class="rashi"><div class="icon">üîÜ</div><div class="label">‡§ó‡•Å‡§∞‡•Å</div><div class="val" id="guruRashi">--</div></div>
        </div>

        <!-- DIN VISHESH -->
        <div id="dinVishesh" class="din-box" style="display:none"></div>

        <!-- FOOTER -->
        <div class="footer" role="contentinfo">
          <div class="footer-left">
            <div class="u-name" id="footerName">‡§Ü‡§™‡§≤‡•á ‡§®‡§æ‡§µ</div>
            <div class="u-office" id="footerOffice">‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä (‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡•Ä)</div>
            <div class="u-contact" id="footerContact">‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï: --</div>
            <div class="u-address" id="footerAddress"></div>
          </div>
          <div>
            <img id="footerPhoto" class="footer-photo" src="" alt="User Photo" style="display:none">
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* CONFIG */
const JSON_LOCAL = './panchang.json';
const JSON_FALLBACK = 'https://sanketramdasi264-prog.github.io/panchang/panchang.json'; // fallback for GitHub pages raw
const daysMar = ['‡§∞‡§µ‡§ø‡§µ‡§æ‡§∞','‡§∏‡•ã‡§Æ‡§µ‡§æ‡§∞','‡§Æ‡§Ç‡§ó‡§≥‡§µ‡§æ‡§∞','‡§¨‡•Å‡§ß‡§µ‡§æ‡§∞','‡§ó‡•Å‡§∞‡•Å‡§µ‡§æ‡§∞','‡§∂‡•Å‡§ï‡•ç‡§∞‡§µ‡§æ‡§∞','‡§∂‡§®‡§ø‡§µ‡§æ‡§∞'];

/* HELPERS */
function todayISO(){
  const d=new Date(); return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}
function fmtDate(d=new Date()){
  return `${String(d.getDate()).padStart(2,'0')}-${String(d.getMonth()+1).padStart(2,'0')}-${d.getFullYear()}`;
}

/* LOAD JSON (try local first, then fallback) */
async function fetchJson(){
  try{
    const r = await fetch(JSON_LOCAL, {cache:'no-store'});
    if(r.ok) return await r.json();
  }catch(e){/*ignore*/}
  try{
    const r2 = await fetch(JSON_FALLBACK, {cache:'no-store'});
    if(r2.ok) return await r2.json();
  }catch(e){/*ignore*/}
  return null;
}

/* FILL UI */
async function fillPanchang(){
  const data = await fetchJson();
  const key = todayISO();
  const now = new Date();
  document.getElementById('hdrDate').textContent = fmtDate(now);
  document.getElementById('hdrDay').textContent = daysMar[now.getDay()];

  if(!data || !data[key]){
    // hide din, show placeholders
    ['tithiName','tithiTime','tithiNext','vaar','vaarTime','vaarSanskrit','nakshatra','nakshatraTime','nakshatraNext','yog','yogTime','yogNext','karan','karanTime','karanNext','sunrise','sunset','moonRashi','sunRashi','guruRashi'].forEach(id=>{
      const el=document.getElementById(id); if(el) el.textContent='--';
    });
    document.getElementById('dinVishesh').style.display='none';
    console.warn('panchang.json missing for', key);
    return;
  }

  const p = data[key];

  // shalivahan
  if(p.shalivahan) document.getElementById('shalivahanLine').textContent = p.shalivahan;
  if(p.shalivahan_meta) document.getElementById('shalivahanMeta').textContent = p.shalivahan_meta;

  // sunrise/sunset
  document.getElementById('sunrise').textContent = p.sunrise || '--';
  document.getElementById('sunset').textContent = p.sunset || '--';

  // format endings: add '‡§™' for end times and '‡§®‡§Ç ' for next
  function endP(val){ return val ? (val + ' ‡§™') : '--'; }
  function nextN(val){ return val ? ('‡§®‡§Ç ' + val) : '--'; }

  // tithi
  document.getElementById('tithiName').textContent = p.tithi || '--';
  document.getElementById('tithiTime').textContent = endP(p.tithi_end || p.tithi_end_raw || p.tithi_end_time);
  document.getElementById('tithiNext').textContent = nextN(p.tithi_next || p.tithiNext);

  // vaar
  document.getElementById('vaar').textContent = p.vaar || daysMar[now.getDay()];
  document.getElementById('vaarTime').textContent = p.vaar_time || '--';
  document.getElementById('vaarSanskrit').textContent = p.vaar_sanskrit || p.vaarSanskrit || '--';

  // nakshatra
  document.getElementById('nakshatra').textContent = p.nakshatra || '--';
  document.getElementById('nakshatraTime').textContent = endP(p.nakshatra_end);
  document.getElementById('nakshatraNext').textContent = nextN(p.nakshatra_next);

  // yoga
  document.getElementById('yog').textContent = p.yog || '--';
  document.getElementById('yogTime').textContent = p.yog_time || '--';
  document.getElementById('yogNext').textContent = nextN(p.yog_next);

  // karan
  document.getElementById('karan').textContent = p.karan || p.karana || '--';
  document.getElementById('karanTime').textContent = endP(p.karan_end);
  document.getElementById('karanNext').textContent = nextN(p.karan_next);

  // rashis
  document.getElementById('moonRashi').textContent = p.moon_rashi || p.moonRashi || '--';
  document.getElementById('sunRashi').textContent = p.sun_rashi || p.sunRashi || '--';
  document.getElementById('guruRashi').textContent = p.guru_rashi || p.guruRashi || '--';

  // din vishesh
  if(p.din_vishesh){
    const dv = document.getElementById('dinVishesh');
    dv.textContent = '‡§¶‡§ø‡§®‡§µ‡§ø‡§∂‡•á‡§∑: ' + p.din_vishesh;
    dv.style.display = 'block';
  } else {
    document.getElementById('dinVishesh').style.display = 'none';
  }
}

/* USER INPUT HANDLING */
let uploadedImageData = '';
document.getElementById('fileInput').addEventListener('change', e=>{
  const f = e.target.files[0];
  if(!f) return;
  const r = new FileReader();
  r.onload = ()=> uploadedImageData = r.result;
  r.readAsDataURL(f);
});

document.getElementById('applyBtn').addEventListener('click', ()=>{
  const name = document.getElementById('nameInput').value.trim();
  const office = document.getElementById('officeInput').value.trim();
  const contact = document.getElementById('contactInput').value.trim();
  const address = document.getElementById('addressInput').value.trim();

  document.getElementById('footerName').textContent = name || '‡§Ü‡§™‡§≤‡•á ‡§®‡§æ‡§µ';
  document.getElementById('footerOffice').textContent = office || '';
  document.getElementById('footerContact').textContent = contact ? ('‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï: ' + contact) : '‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï: --';
  document.getElementById('footerAddress').textContent = address ? ('‡§™‡§§‡•ç‡§§‡§æ: ' + address) : '';

  if(uploadedImageData){
    const fp = document.getElementById('footerPhoto');
    fp.src = uploadedImageData;
    fp.style.display = 'block';
  }
});

/* DOWNLOAD: ensure logo included in canvas by using images with crossOrigin and inline <img> */
async function downloadImage(){
  // apply footer first (in case user didn't click apply)
  document.getElementById('applyBtn').click();
  await new Promise(r=>setTimeout(r,220)); // let images render

  const card = document.getElementById('panchangCard');

  // html2canvas render at true pixel size
  html2canvas(card, {
    scale: 2,
    useCORS: true,
    allowTaint: false,
    backgroundColor: '#ffffff',
    width: parseInt(getComputedStyle(card).width),
    height: parseInt(getComputedStyle(card).height)
  }).then(canvas=>{
    canvas.toBlob(blob=>{
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      const name = (document.getElementById('nameInput').value||'panchang').replace(/\s+/g,'_');
      const d = new Date();
      a.download = `panchang_${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}_${name}.png`;
      a.href = url; document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url),500);
    }, 'image/png');
  }).catch(err=>{
    console.error(err);
    alert('‡§ö‡§ø‡§§‡•ç‡§∞ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§§‡§æ‡§®‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§Ü‡§≤‡•Ä. Console ‡§§‡§™‡§æ‡§∏‡§æ.');
  });
}

/* small helper to ensure logos/images loaded with crossorigin */
function ensureCrossOrigin(img){
  try{ img.crossOrigin = 'anonymous'; }catch(e){}
}

/* Wire a keyboard-friendly download shortcut (Ctrl/Cmd+D) */
document.addEventListener('keydown', e=>{
  if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='d'){
    e.preventDefault(); downloadImage();
  }
});

/* Initial */
window.addEventListener('load', async ()=>{
  // try to set crossOrigin for images already present
  ensureCrossOrigin(document.getElementById('ganeshImg'));
  ensureCrossOrigin(document.getElementById('logoImg'));
  ensureCrossOrigin(document.getElementById('footerPhoto'));

  await fillPanchang();
});

/* Expose download function on global (for easy button binding if needed) */
window.downloadPanchangImage = downloadImage;
</script>

<!-- Small floating download button bottom-right -->
<div style="position:fixed;right:18px;bottom:18px;z-index:9999">
  <button onclick="downloadPanchangImage()" style="background:linear-gradient(135deg,#d32f2f,#c62828);color:#fff;border:none;padding:14px 18px;border-radius:10px;font-weight:800;box-shadow:0 8px 28px rgba(0,0,0,.2);cursor:pointer">Download PNG</button>
</div>
</body>
</html>
